package org.nfl.data;

import Jama.Matrix;
import Jama.QRDecomposition;


/**
 *  The {@code MultipleLinearRegression} class performs a multiple linear regression
 *  on an set of <em>N</em> data points using the model
 *  <em>y</em> = &beta;<sub>0</sub> + &beta;<sub>1</sub> <em>x</em><sub>1</sub> + ... +
 &beta;<sub><em>p</em></sub> <em>x<sub>p</sub></em>,
 *  where <em>y</em> is the response (or dependent) variable,
 *  and <em>x</em><sub>1</sub>, <em>x</em><sub>2</sub>, ..., <em>x<sub>p</sub></em>
 *  are the <em>p</em> predictor (or independent) variables.
 *  The parameters &beta;<sub><em>i</em></sub> are chosen to minimize
 *  the sum of squared residuals of the multiple linear regression model.
 *  It also computes the coefficient of determination <em>R</em><sup>2</sup>.
 *
 *  @author Robert Sedgewick
 *  @author Kevin Wayne
 */
public class MultipleLinearRegression {
    private final Matrix beta;  // regression coefficients
    private double sse;         // sum of squared
    private double sst;         // sum of squared

    /**
     * Performs a linear regression on the data points {@code (y[i], x[i][j])}.
     * @param  x the values of the predictor variables
     * @param  y the corresponding values of the response variable
     * @throws IllegalArgumentException if the lengths of the two arrays are not equal
     */
    public MultipleLinearRegression(double[][] x, double[] y) {
        if (x.length != y.length) {
            throw new IllegalArgumentException("matrix dimensions don't agree");
        }

        // number of observations
        int n = y.length;

        Matrix matrixX = new Matrix(x);

        // create matrix from vector
        Matrix matrixY = new Matrix(y, n);

        // find least squares solution
        QRDecomposition qr = new QRDecomposition(matrixX);
        beta = qr.solve(matrixY);


        // mean of y[] values
        double sum = 0.0;
        for (int i = 0; i < n; i++)
            sum += y[i];
        double mean = sum / n;

        // total variation to be accounted for
        for (int i = 0; i < n; i++) {
            double dev = y[i] - mean;
            sst += dev*dev;
        }

        // variation not accounted for
        Matrix residuals = matrixX.times(beta).minus(matrixY);
        sse = residuals.norm2() * residuals.norm2();

    }

    /**
     * Returns the least squares estimate of &beta;<sub><em>j</em></sub>.
     *
     * @param  j the index
     * @return the estimate of &beta;<sub><em>j</em></sub>
     */
    public double beta(int j) {
        return beta.get(j, 0);
    }

    /**
     * Returns the coefficient of determination <em>R</em><sup>2</sup>.
     *
     * @return the coefficient of determination <em>R</em><sup>2</sup>,
     *         which is a real number between 0 and 1
     */
    public double R2() {
        return 1.0 - sse/sst;
    }

    /**
     * Unit tests the {@code MultipleLinearRegression} data type.
     *
     * @param args the command-line arguments
     */
    public static void main(String[] args) {

        double[][] x = {
                { 80.100000, 7.000000, 0.000000, 9.900000, 3.500000, 79.600000, 54.100000, 40.760000, 0.000000, 11.000000, 16.600000, -3.760000, 21.800000, 336.500000, 58.300000, 5.800000, 1.410000, 0.410000, 18.900000, 18.500000, 28.100000, 1.290000, 1.000000, 9.590000, 5.880000, 1.710000, 38.200000, -3.760000, 3.705882 },
                { 102.900000, 11.700000, 0.000000, 9.800000, 3.500000, 53.100000, 75.900000, 61.770000, 0.000000, 12.600000, 20.200000, -2.150000, 21.100000, 324.300000, 63.100000, 5.100000, 1.180000, 0.590000, 18.500000, 21.400000, 33.500000, 1.710000, 0.590000, 10.900000, 5.710000, 1.470000, 33.000000, -2.150000, 2.000000 },
                { 81.800000, 3.700000, 0.000000, 9.900000, 3.500000, 0.000000, 52.400000, 34.580000, 0.000000, 13.100000, 20.200000, -3.860000, 21.700000, 328.200000, 64.300000, 5.100000, 1.180000, 0.530000, 19.800000, 24.000000, 36.400000, 1.940000, 0.650000, 12.200000, 5.760000, 1.650000, 35.900000, -3.860000, 4.000000 },
                { 81.800000, 4.400000, 0.000000, 9.900000, 4.500000, 0.000000, 56.600000, 41.730000, 0.000000, 11.700000, 18.800000, 0.430000, 21.100000, 320.000000, 63.500000, 5.000000, 1.350000, 0.470000, 19.100000, 23.100000, 35.600000, 1.180000, 0.880000, 10.600000, 6.240000, 2.060000, 35.900000, 0.430000, 3.666667 },
                { 67.400000, 4.700000, 0.000000, 9.900000, 3.500000, 18.900000, 64.900000, 91.580000, 0.000000, 11.000000, 18.000000, 0.430000, 20.200000, 304.600000, 58.700000, 5.200000, 1.060000, 0.530000, 16.800000, 18.100000, 30.200000, 1.530000, 0.530000, 9.120000, 5.000000, 1.710000, 31.500000, 0.430000, 4.750000 },
                { 56.200000, 11.700000, 0.000000, 9.900000, 4.500000, 90.200000, 41.900000, 58.640000, 17.200000, 14.700000, 22.200000, -6.120000, 25.100000, 388.700000, 65.800000, 5.900000, 1.470000, 0.590000, 21.100000, 24.000000, 36.300000, 1.350000, 0.880000, 13.200000, 6.530000, 1.290000, 41.100000, -6.120000, 5.400000 },
                { 56.300000, 3.900000, 0.000000, 9.900000, 4.500000, 47.800000, 39.200000, 52.640000, 0.000000, 12.200000, 18.500000, -7.770000, 24.600000, 365.600000, 63.400000, 5.800000, 0.760000, 0.410000, 21.200000, 23.500000, 34.700000, 1.470000, 0.350000, 12.100000, 5.470000, 1.650000, 40.800000, -7.770000, 5.333333 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 4.500000, 0.000000, 0.000000, 50.000000, 0.000000, 10.700000, 17.400000, -4.970000, 22.600000, 346.100000, 58.900000, 5.900000, 1.410000, 0.590000, 18.700000, 18.200000, 29.700000, 1.410000, 0.820000, 10.300000, 4.710000, 1.410000, 37.200000, -4.970000, 5.714286 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 5.500000, 0.000000, 0.000000, 50.000000, 0.000000, 11.400000, 18.100000, -1.800000, 20.300000, 314.800000, 63.300000, 5.000000, 0.820000, 0.410000, 18.800000, 18.900000, 31.500000, 1.000000, 0.410000, 9.350000, 5.410000, 2.240000, 34.800000, -1.800000, 5.500000 },
                { 42.400000, 7.500000, 0.000000, 9.900000, 4.500000, 24.600000, 29.300000, 51.450000, 0.000000, 14.400000, 21.200000, -3.060000, 22.000000, 350.200000, 64.900000, 5.400000, 1.000000, 0.410000, 20.400000, 22.500000, 34.100000, 1.470000, 0.590000, 11.400000, 6.180000, 1.590000, 34.200000, -3.060000, 5.222222 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 4.500000, 0.000000, 0.000000, 50.000000, 0.000000, 13.400000, 20.900000, -9.390000, 25.100000, 392.400000, 63.300000, 6.200000, 1.290000, 0.590000, 22.200000, 20.800000, 32.900000, 1.530000, 0.710000, 12.300000, 6.060000, 1.940000, 41.200000, -9.390000, 5.200000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 4.500000, 0.000000, 0.000000, 50.000000, 0.000000, 14.700000, 22.200000, -6.120000, 25.100000, 388.700000, 65.800000, 5.900000, 1.470000, 0.590000, 21.100000, 24.000000, 36.300000, 1.350000, 0.880000, 13.200000, 6.530000, 1.290000, 41.100000, -6.120000, 5.363636 },
                { 28.000000, 10.300000, 0.000000, 9.900000, 5.500000, 100.000000, 26.500000, 69.190000, 16.100000, 13.400000, 20.900000, -9.390000, 25.100000, 392.400000, 63.300000, 6.200000, 1.290000, 0.590000, 22.200000, 20.800000, 32.900000, 1.530000, 0.710000, 12.300000, 6.060000, 1.940000, 41.200000, -9.390000, 5.833333 },
                { 38.600000, 19.600000, 0.030000, 9.900000, 4.500000, 100.000000, 39.800000, 78.660000, 32.100000, 9.940000, 16.700000, -3.410000, 22.400000, 331.200000, 61.200000, 5.400000, 1.180000, 0.530000, 19.400000, 18.500000, 30.500000, 1.180000, 0.650000, 9.760000, 5.180000, 2.000000, 38.500000, -3.410000, 5.846154 },
                { 54.900000, 8.900000, 0.000000, 9.900000, 5.500000, 100.000000, 49.100000, 80.730000, 0.000000, 12.400000, 19.200000, -4.810000, 26.400000, 348.900000, 63.200000, 5.500000, 1.180000, 0.530000, 21.400000, 24.400000, 34.900000, 1.710000, 0.650000, 12.800000, 5.530000, 1.240000, 41.600000, -4.810000, 5.714286 },
                { 26.000000, 9.800000, 0.000000, 6.500000, 4.500000, 100.000000, 29.200000, 83.360000, 0.000000, 12.500000, 19.300000, -7.260000, 22.700000, 362.100000, 63.600000, 5.700000, 1.000000, 0.410000, 20.600000, 21.900000, 33.000000, 1.530000, 0.590000, 11.800000, 5.880000, 0.880000, 43.500000, -7.260000, 5.533333 },
                { 27.800000, 5.800000, 0.000000, 9.900000, 5.500000, 100.000000, 26.200000, 75.200000, 0.000000, 11.000000, 16.600000, -3.760000, 21.800000, 336.500000, 58.300000, 5.800000, 1.410000, 0.410000, 18.900000, 18.500000, 28.100000, 1.290000, 1.000000, 9.590000, 5.880000, 1.710000, 38.200000, -3.760000, 5.750000 },
                { 65.100000, 6.400000, 0.000000, 9.700000, 5.500000, 95.600000, 50.200000, 58.560000, 0.000000, 11.700000, 18.800000, 0.430000, 21.100000, 320.000000, 63.500000, 5.000000, 1.350000, 0.470000, 19.100000, 23.100000, 35.600000, 1.180000, 0.880000, 10.600000, 6.240000, 2.060000, 35.900000, 0.430000, 5.882353 },
                { 70.200000, 5.300000, 0.000000, 9.900000, 5.500000, 65.400000, 52.800000, 54.150000, 0.000000, 12.600000, 20.300000, 0.280000, 17.900000, 319.100000, 62.300000, 5.100000, 1.690000, 0.630000, 19.600000, 22.600000, 35.600000, 1.310000, 1.060000, 11.300000, 5.560000, 1.810000, 31.000000, 0.280000, 6.000000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 5.500000, 0.000000, 0.000000, 50.000000, 0.000000, 10.700000, 18.500000, -2.770000, 20.400000, 330.400000, 60.200000, 5.500000, 1.350000, 0.180000, 18.500000, 19.500000, 31.900000, 1.710000, 1.180000, 11.500000, 5.650000, 1.350000, 37.300000, -2.770000, 6.000000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 5.500000, 0.000000, 0.000000, 50.000000, 0.000000, 10.700000, 17.400000, -4.970000, 22.600000, 346.100000, 58.900000, 5.900000, 1.410000, 0.590000, 18.700000, 18.200000, 29.700000, 1.410000, 0.820000, 10.300000, 4.710000, 1.410000, 37.200000, -4.970000, 8.333333 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 6.500000, 0.000000, 0.000000, 50.000000, 0.000000, 11.000000, 16.600000, -3.760000, 21.800000, 336.500000, 58.300000, 5.800000, 1.410000, 0.410000, 18.900000, 18.500000, 28.100000, 1.290000, 1.000000, 9.590000, 5.880000, 1.710000, 38.200000, -3.760000, 8.250000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 6.500000, 0.000000, 0.000000, 50.000000, 0.000000, 12.200000, 19.800000, 3.260000, 20.400000, 322.000000, 64.200000, 5.000000, 1.760000, 0.650000, 18.500000, 21.400000, 35.100000, 1.650000, 1.120000, 11.400000, 5.240000, 1.760000, 30.500000, 3.260000, 7.400000 },
                { 56.300000, 3.900000, 0.000000, 9.900000, 5.500000, 47.800000, 39.200000, 52.640000, 0.000000, 10.800000, 16.400000, -9.950000, 27.200000, 375.900000, 61.400000, 6.100000, 1.350000, 0.530000, 21.200000, 19.000000, 28.300000, 1.290000, 0.820000, 10.800000, 4.940000, 1.530000, 41.800000, -9.950000, 6.500000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 5.500000, 0.000000, 0.000000, 50.000000, 0.000000, 13.400000, 20.900000, -9.390000, 25.100000, 392.400000, 63.300000, 6.200000, 1.290000, 0.590000, 22.200000, 20.800000, 32.900000, 1.530000, 0.710000, 12.300000, 6.060000, 1.940000, 41.200000, -9.390000, 6.571429 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 6.500000, 0.000000, 0.000000, 50.000000, 0.000000, 12.600000, 21.200000, -7.370000, 21.800000, 358.200000, 63.400000, 5.600000, 1.120000, 0.760000, 21.800000, 20.500000, 33.400000, 1.240000, 0.350000, 11.800000, 6.530000, 2.120000, 39.800000, -7.370000, 5.875000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 5.500000, 0.000000, 0.000000, 50.000000, 0.000000, 9.880000, 16.600000, 1.530000, 18.600000, 311.100000, 64.300000, 4.800000, 0.940000, 0.240000, 18.200000, 20.400000, 32.700000, 0.880000, 0.710000, 9.760000, 5.290000, 1.590000, 32.300000, 1.530000, 5.666667 },
                { 83.100000, 8.100000, 0.000000, 9.900000, 5.500000, 43.900000, 66.500000, 61.910000, 18.300000, 13.200000, 21.100000, -3.910000, 23.500000, 337.800000, 63.900000, 5.300000, 0.820000, 0.350000, 19.800000, 24.500000, 36.700000, 1.590000, 0.470000, 11.800000, 4.940000, 2.240000, 37.500000, -3.910000, 5.700000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 5.500000, 0.000000, 0.000000, 50.000000, 0.000000, 13.100000, 20.200000, -3.860000, 21.700000, 328.200000, 64.300000, 5.100000, 1.180000, 0.530000, 19.800000, 24.000000, 36.400000, 1.940000, 0.650000, 12.200000, 5.760000, 1.650000, 35.900000, -3.860000, 5.818182 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 5.500000, 0.000000, 0.000000, 50.000000, 0.000000, 14.700000, 22.200000, -6.120000, 25.100000, 388.700000, 65.800000, 5.900000, 1.470000, 0.590000, 21.100000, 24.000000, 36.300000, 1.350000, 0.880000, 13.200000, 6.530000, 1.290000, 41.100000, -6.120000, 5.750000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 6.500000, 0.000000, 0.000000, 50.000000, 0.000000, 10.700000, 17.400000, -4.970000, 22.600000, 346.100000, 58.900000, 5.900000, 1.410000, 0.590000, 18.700000, 18.200000, 29.700000, 1.410000, 0.820000, 10.300000, 4.710000, 1.410000, 37.200000, -4.970000, 5.846154 },
                { 28.400000, 13.900000, 0.000000, 8.900000, 5.500000, 100.000000, 33.100000, 85.550000, 22.500000, 13.100000, 20.200000, -3.860000, 21.700000, 328.200000, 64.300000, 5.100000, 1.180000, 0.530000, 19.800000, 24.000000, 36.400000, 1.940000, 0.650000, 12.200000, 5.760000, 1.650000, 35.900000, -3.860000, 6.000000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 5.500000, 0.000000, 0.000000, 50.000000, 0.000000, 11.600000, 17.600000, -3.000000, 25.100000, 334.000000, 64.200000, 5.200000, 1.240000, 0.650000, 20.200000, 21.500000, 31.600000, 1.470000, 0.590000, 10.800000, 5.240000, 1.940000, 36.000000, -3.000000, 5.666667 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 6.500000, 0.000000, 0.000000, 50.000000, 0.000000, 11.700000, 18.800000, 0.430000, 21.100000, 320.000000, 63.500000, 5.000000, 1.350000, 0.470000, 19.100000, 23.100000, 35.600000, 1.180000, 0.880000, 10.600000, 6.240000, 2.060000, 35.900000, 0.430000, 6.125000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 6.500000, 0.000000, 0.000000, 50.000000, 0.000000, 13.200000, 21.100000, -3.910000, 23.500000, 337.800000, 63.900000, 5.300000, 0.820000, 0.350000, 19.800000, 24.500000, 36.700000, 1.590000, 0.470000, 11.800000, 4.940000, 2.240000, 37.500000, -3.910000, 6.600000 },
                { 74.900000, 4.000000, 0.000000, 9.900000, 6.500000, 60.600000, 57.900000, 55.330000, 0.000000, 14.500000, 22.100000, -3.070000, 21.100000, 351.600000, 64.700000, 5.400000, 1.180000, 0.350000, 19.900000, 25.800000, 39.500000, 1.710000, 0.820000, 12.600000, 6.760000, 1.820000, 33.900000, -3.070000, 6.000000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 6.500000, 0.000000, 0.000000, 50.000000, 0.000000, 14.700000, 22.200000, -6.120000, 25.100000, 388.700000, 65.800000, 5.900000, 1.470000, 0.590000, 21.100000, 24.000000, 36.300000, 1.350000, 0.880000, 13.200000, 6.530000, 1.290000, 41.100000, -6.120000, 7.000000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 7.500000, 0.000000, 0.000000, 50.000000, 0.000000, 12.200000, 18.500000, -7.770000, 24.600000, 365.600000, 63.400000, 5.800000, 0.760000, 0.410000, 21.200000, 23.500000, 34.700000, 1.470000, 0.350000, 12.100000, 5.470000, 1.650000, 40.800000, -7.770000, 10.666667 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 7.500000, 0.000000, 0.000000, 50.000000, 0.000000, 12.000000, 19.100000, 1.870000, 20.100000, 330.200000, 64.800000, 5.100000, 1.940000, 1.000000, 19.200000, 20.300000, 32.400000, 1.350000, 0.940000, 10.200000, 5.760000, 2.000000, 33.500000, 1.870000, 8.750000 },
                { 73.000000, 10.700000, 0.000000, 9.900000, 7.500000, 0.000000, 41.100000, 31.580000, 0.000000, 13.100000, 20.200000, -3.860000, 21.700000, 328.200000, 64.300000, 5.100000, 1.180000, 0.530000, 19.800000, 24.000000, 36.400000, 1.940000, 0.650000, 12.200000, 5.760000, 1.650000, 35.900000, -3.860000, 8.400000 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 7.500000, 0.000000, 0.000000, 50.000000, 0.000000, 10.800000, 16.400000, -9.950000, 27.200000, 375.900000, 61.400000, 6.100000, 1.350000, 0.530000, 21.200000, 19.000000, 28.300000, 1.290000, 0.820000, 10.800000, 4.940000, 1.530000, 41.800000, -9.950000, 7.666667 },
                { 51.600000, 3.600000, 0.000000, 9.900000, 6.500000, 5.300000, 46.200000, 81.490000, 0.000000, 9.880000, 16.600000, 1.530000, 18.600000, 311.100000, 64.300000, 4.800000, 0.940000, 0.240000, 18.200000, 20.400000, 32.700000, 0.880000, 0.710000, 9.760000, 5.290000, 1.590000, 32.300000, 1.530000, 7.714286 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 6.500000, 0.000000, 0.000000, 50.000000, 0.000000, 13.400000, 20.900000, -9.390000, 25.100000, 392.400000, 63.300000, 6.200000, 1.290000, 0.590000, 22.200000, 20.800000, 32.900000, 1.530000, 0.710000, 12.300000, 6.060000, 1.940000, 41.200000, -9.390000, 7.750000 },
                { 41.400000, 4.700000, 0.000000, 9.900000, 7.500000, 0.000000, 30.800000, 59.340000, 0.000000, 11.000000, 16.600000, -3.760000, 21.800000, 336.500000, 58.300000, 5.800000, 1.410000, 0.410000, 18.900000, 18.500000, 28.100000, 1.290000, 1.000000, 9.590000, 5.880000, 1.710000, 38.200000, -3.760000, 8.111111 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 7.500000, 0.000000, 0.000000, 50.000000, 0.000000, 13.500000, 20.800000, -1.900000, 18.500000, 324.300000, 61.600000, 5.300000, 1.470000, 0.650000, 19.000000, 23.200000, 34.900000, 1.180000, 0.820000, 12.100000, 4.650000, 1.530000, 35.800000, -1.900000, 8.300000 },
                { 41.900000, 9.900000, 0.050000, 7.100000, 7.500000, 100.000000, 42.600000, 85.700000, 17.200000, 12.200000, 19.800000, 3.260000, 20.400000, 322.000000, 64.200000, 5.000000, 1.760000, 0.650000, 18.500000, 21.400000, 35.100000, 1.650000, 1.120000, 11.400000, 5.240000, 1.760000, 30.500000, 3.260000, 8.818182 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 7.500000, 0.000000, 0.000000, 50.000000, 0.000000, 11.700000, 18.800000, 0.430000, 21.100000, 320.000000, 63.500000, 5.000000, 1.350000, 0.470000, 19.100000, 23.100000, 35.600000, 1.180000, 0.880000, 10.600000, 6.240000, 2.060000, 35.900000, 0.430000, 8.500000 },
                { 72.600000, 6.700000, 0.030000, 8.500000, 4.500000, 93.500000, 69.300000, 89.510000, 0.000000, 12.200000, 19.800000, 3.260000, 20.400000, 322.000000, 64.200000, 5.000000, 1.760000, 0.650000, 18.500000, 21.400000, 35.100000, 1.650000, 1.120000, 11.400000, 5.240000, 1.760000, 30.500000, 3.260000, 5.176471 },
                { 67.700000, 14.300000, 0.000000, 9.900000, 5.500000, 0.000000, 48.100000, 49.450000, 24.200000, 14.700000, 22.200000, -6.120000, 25.100000, 388.700000, 65.800000, 5.900000, 1.470000, 0.590000, 21.100000, 24.000000, 36.300000, 1.350000, 0.880000, 13.200000, 6.530000, 1.290000, 41.100000, -6.120000, 7.000000 },
                { 86.400000, 6.700000, 0.040000, 9.700000, 5.500000, 76.600000, 74.900000, 82.350000, 0.000000, 12.600000, 20.200000, -2.150000, 21.100000, 324.300000, 63.100000, 5.100000, 1.180000, 0.590000, 18.500000, 21.400000, 33.500000, 1.710000, 0.590000, 10.900000, 5.710000, 1.470000, 33.000000, -2.150000, 5.500000 },
                { 79.000000, 10.500000, 0.000000, 9.900000, 5.500000, 24.900000, 56.100000, 45.500000, 0.000000, 11.000000, 18.000000, 0.430000, 20.200000, 304.600000, 58.700000, 5.200000, 1.060000, 0.530000, 16.800000, 18.100000, 30.200000, 1.530000, 0.530000, 9.120000, 5.000000, 1.710000, 31.500000, 0.430000, 6.666667 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 5.500000, 0.000000, 0.000000, 50.000000, 0.000000, 13.600000, 19.500000, -4.450000, 22.600000, 341.100000, 61.700000, 5.500000, 1.290000, 0.350000, 19.500000, 22.100000, 32.700000, 1.350000, 0.940000, 11.900000, 4.820000, 1.290000, 41.000000, -4.450000, 7.250000 },
                { 56.900000, 10.800000, 0.000000, 9.900000, 5.500000, 82.900000, 39.000000, 51.040000, 18.300000, 9.880000, 16.600000, 1.530000, 18.600000, 311.100000, 64.300000, 4.800000, 0.940000, 0.240000, 18.200000, 20.400000, 32.700000, 0.880000, 0.710000, 9.760000, 5.290000, 1.590000, 32.300000, 1.530000, 7.000000 },
                { 53.000000, 8.100000, 0.000000, 9.900000, 5.500000, 28.000000, 32.000000, 44.680000, 0.000000, 13.200000, 21.100000, -3.910000, 23.500000, 337.800000, 63.900000, 5.300000, 0.820000, 0.350000, 19.800000, 24.500000, 36.700000, 1.590000, 0.470000, 11.800000, 4.940000, 2.240000, 37.500000, -3.910000, 7.000000 },
                { 75.800000, 6.000000, 0.000000, 9.900000, 5.500000, 46.100000, 62.300000, 62.830000, 0.000000, 11.000000, 18.000000, 0.430000, 20.200000, 304.600000, 58.700000, 5.200000, 1.060000, 0.530000, 16.800000, 18.100000, 30.200000, 1.530000, 0.530000, 9.120000, 5.000000, 1.710000, 31.500000, 0.430000, 7.428571 },
                { 64.500000, 5.800000, 0.000000, 9.900000, 5.500000, 24.900000, 37.200000, 36.280000, 0.000000, 12.000000, 19.100000, 1.870000, 20.100000, 330.200000, 64.800000, 5.100000, 1.940000, 1.000000, 19.200000, 20.300000, 32.400000, 1.350000, 0.940000, 10.200000, 5.760000, 2.000000, 33.500000, 1.870000, 7.500000 },
                { 38.800000, 12.300000, 0.010000, 6.400000, 6.500000, 100.000000, 42.100000, 90.070000, 0.000000, 13.100000, 20.200000, -3.860000, 21.700000, 328.200000, 64.300000, 5.100000, 1.180000, 0.530000, 19.800000, 24.000000, 36.400000, 1.940000, 0.650000, 12.200000, 5.760000, 1.650000, 35.900000, -3.860000, 7.444444 },
                { 41.200000, 6.800000, 0.040000, 2.500000, 6.500000, 100.000000, 43.000000, 92.970000, 0.000000, 12.600000, 20.300000, 0.280000, 17.900000, 319.100000, 62.300000, 5.100000, 1.690000, 0.630000, 19.600000, 22.600000, 35.600000, 1.310000, 1.060000, 11.300000, 5.560000, 1.810000, 31.000000, 0.280000, 6.800000 },
                { 52.100000, 4.700000, 0.000000, 2.500000, 5.500000, 100.000000, 51.900000, 99.110000, 0.000000, 13.000000, 19.700000, 3.310000, 16.300000, 300.600000, 60.400000, 5.000000, 1.760000, 0.590000, 17.100000, 22.900000, 34.900000, 1.180000, 1.180000, 11.100000, 5.650000, 1.530000, 25.700000, 3.310000, 6.636364 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 6.500000, 0.000000, 0.000000, 50.000000, 0.000000, 12.000000, 19.100000, 1.870000, 20.100000, 330.200000, 64.800000, 5.100000, 1.940000, 1.000000, 19.200000, 20.300000, 32.400000, 1.350000, 0.940000, 10.200000, 5.760000, 2.000000, 33.500000, 1.870000, 6.750000 },
                { 47.200000, 0.800000, 0.000000, 9.700000, 6.500000, 100.000000, 43.400000, 86.670000, 0.000000, 10.100000, 17.000000, -6.660000, 23.600000, 361.700000, 65.700000, 5.500000, 1.470000, 0.650000, 20.400000, 20.200000, 32.200000, 1.350000, 0.820000, 11.100000, 5.760000, 1.710000, 37.200000, -6.660000, 6.923077 },
                { 48.900000, 0.200000, 0.000000, 9.900000, 5.500000, 100.000000, 41.200000, 74.510000, 0.000000, 12.600000, 21.200000, -7.370000, 21.800000, 358.200000, 63.400000, 5.600000, 1.120000, 0.760000, 21.800000, 20.500000, 33.400000, 1.240000, 0.350000, 11.800000, 6.530000, 2.120000, 39.800000, -7.370000, 6.785714 },
                { 40.000000, 9.100000, 0.000000, 9.900000, 6.500000, 100.000000, 25.000000, 45.470000, 0.000000, 12.400000, 19.200000, -4.810000, 26.400000, 348.900000, 63.200000, 5.500000, 1.180000, 0.530000, 21.400000, 24.400000, 34.900000, 1.710000, 0.650000, 12.800000, 5.530000, 1.240000, 41.600000, -4.810000, 6.733333 },
                { 70.000000, 0.000000, 0.000000, 10.000000, 6.500000, 0.000000, 0.000000, 50.000000, 0.000000, 10.700000, 17.400000, -4.970000, 22.600000, 346.100000, 58.900000, 5.900000, 1.410000, 0.590000, 18.700000, 18.200000, 29.700000, 1.410000, 0.820000, 10.300000, 4.710000, 1.410000, 37.200000, -4.970000, 7.000000 },
                { 65.400000, 3.800000, 0.000000, 9.900000, 6.500000, 0.000000, 55.800000, 70.980000, 0.000000, 12.200000, 19.800000, 3.260000, 20.400000, 322.000000, 64.200000, 5.000000, 1.760000, 0.650000, 18.500000, 21.400000, 35.100000, 1.650000, 1.120000, 11.400000, 5.240000, 1.760000, 30.500000, 3.260000, 11.000000 },
                { 96.900000, 12.000000, 0.000000, 9.900000, 6.500000, 31.400000, 73.800000, 62.610000, 17.200000, 11.700000, 18.800000, 0.430000, 21.100000, 320.000000, 63.500000, 5.000000, 1.350000, 0.470000, 19.100000, 23.100000, 35.600000, 1.180000, 0.880000, 10.600000, 6.240000, 2.060000, 35.900000, 0.430000, 8.000000 },
                { 76.000000, 7.200000, 0.000000, 9.900000, 6.500000, 36.800000, 61.700000, 61.450000, 0.000000, 12.600000, 20.300000, 0.280000, 17.900000, 319.100000, 62.300000, 5.100000, 1.690000, 0.630000, 19.600000, 22.600000, 35.600000, 1.310000, 1.060000, 11.300000, 5.560000, 1.810000, 31.000000, 0.280000, 8.333333 },
                { 95.500000, 9.800000, 0.000000, 9.900000, 6.500000, 48.100000, 72.600000, 60.370000, 0.000000, 12.600000, 21.200000, -7.370000, 21.800000, 358.200000, 63.400000, 5.600000, 1.120000, 0.760000, 21.800000, 20.500000, 33.400000, 1.240000, 0.350000, 11.800000, 6.530000, 2.120000, 39.800000, -7.370000, 7.000000 },
                { 90.300000, 9.400000, 0.000000, 9.900000, 6.500000, 21.500000, 68.700000, 55.740000, 18.300000, 14.400000, 21.200000, -3.060000, 22.000000, 350.200000, 64.900000, 5.400000, 1.000000, 0.410000, 20.400000, 22.500000, 34.100000, 1.470000, 0.590000, 11.400000, 6.180000, 1.590000, 34.200000, -3.060000, 7.200000 },
                { 53.000000, 8.100000, 0.000000, 9.900000, 7.500000, 28.000000, 32.000000, 44.680000, 0.000000, 10.800000, 18.000000, 1.220000, 20.200000, 301.500000, 63.100000, 4.800000, 1.590000, 0.590000, 19.100000, 20.600000, 32.700000, 1.290000, 1.000000, 10.900000, 5.590000, 1.410000, 32.400000, 1.220000, 7.000000 },
                { 88.900000, 18.800000, 0.000000, 9.900000, 6.500000, 76.000000, 70.500000, 63.460000, 27.300000, 12.200000, 19.800000, 3.260000, 20.400000, 322.000000, 64.200000, 5.000000, 1.760000, 0.650000, 18.500000, 21.400000, 35.100000, 1.650000, 1.120000, 11.400000, 5.240000, 1.760000, 30.500000, 3.260000, 7.571429 },
                { 52.700000, 13.800000, 0.010000, 10.700000, 7.500000, 0.000000, 47.000000, 80.840000, 0.000000, 13.100000, 20.200000, -3.860000, 21.700000, 328.200000, 64.300000, 5.100000, 1.180000, 0.530000, 19.800000, 24.000000, 36.400000, 1.940000, 0.650000, 12.200000, 5.760000, 1.650000, 35.900000, -3.860000, 7.625000 },
                { 83.100000, 8.100000, 0.000000, 9.900000, 6.500000, 43.900000, 66.500000, 61.910000, 18.300000, 12.200000, 18.500000, -7.770000, 24.600000, 365.600000, 63.400000, 5.800000, 0.760000, 0.410000, 21.200000, 23.500000, 34.700000, 1.470000, 0.350000, 12.100000, 5.470000, 1.650000, 40.800000, -7.770000, 7.666667 },
                { 44.200000, 11.000000, 0.000000, 9.900000, 5.500000, 5.300000, 23.600000, 36.940000, 17.600000, 9.880000, 16.600000, 1.530000, 18.600000, 311.100000, 64.300000, 4.800000, 0.940000, 0.240000, 18.200000, 20.400000, 32.700000, 0.880000, 0.710000, 9.760000, 5.290000, 1.590000, 32.300000, 1.530000, 7.900000 },
                { 54.100000, 0.100000, 0.000000, 1.000000, 7.500000, 100.000000, 53.000000, 95.780000, 0.000000, 11.000000, 18.000000, 0.430000, 20.200000, 304.600000, 58.700000, 5.200000, 1.060000, 0.530000, 16.800000, 18.100000, 30.200000, 1.530000, 0.530000, 9.120000, 5.000000, 1.710000, 31.500000, 0.430000, 8.000000 },
                { 61.300000, 10.700000, 0.000000, 9.900000, 7.500000, 5.400000, 54.700000, 78.910000, 19.700000, 14.500000, 22.100000, -3.070000, 21.100000, 351.600000, 64.700000, 5.400000, 1.180000, 0.350000, 19.900000, 25.800000, 39.500000, 1.710000, 0.820000, 12.600000, 6.760000, 1.820000, 33.900000, -3.070000, 7.750000 },
                { 72.400000, 12.100000, 0.000000, 9.900000, 6.500000, 96.400000, 64.300000, 75.810000, 25.500000, 12.000000, 19.100000, 1.870000, 20.100000, 330.200000, 64.800000, 5.100000, 1.940000, 1.000000, 19.200000, 20.300000, 32.400000, 1.350000, 0.940000, 10.200000, 5.760000, 2.000000, 33.500000, 1.870000, 7.461538 },
                { 45.700000, 9.600000, 0.000000, 9.900000, 7.500000, 86.800000, 28.500000, 43.870000, 17.200000, 13.500000, 20.800000, -1.900000, 18.500000, 324.300000, 61.600000, 5.300000, 1.470000, 0.650000, 19.000000, 23.200000, 34.900000, 1.180000, 0.820000, 12.100000, 4.650000, 1.530000, 35.800000, -1.900000, 7.571429 },
                { 61.400000, 6.200000, 0.000000, 9.900000, 7.500000, 1.700000, 52.100000, 71.410000, 0.000000, 12.600000, 20.300000, 0.280000, 17.900000, 319.100000, 62.300000, 5.100000, 1.690000, 0.630000, 19.600000, 22.600000, 35.600000, 1.310000, 1.060000, 11.300000, 5.560000, 1.810000, 31.000000, 0.280000, 7.466667 },
                };
        double[] y = { 2, 6, 3, 8, 8, 5, 8, 4, 3, 5, 7, 11, 6, 4, 3, 9, 4, 6, 6, 13, 8, 4, 2, 7, 1, 4, 6, 7, 5, 7, 8, 1, 13, 5, 6, 8, 18, 3, 7, 4, 8, 8, 11, 10, 14, 5, 6, 7, 4, 9, 9, 6, 7, 10, 8, 7, 1, 5, 8, 9, 5, 6, 4, 11, 5, 9, 3, 8, 6, 11, 8, 8, 10, 9, 5, 4, 9, 6, 7, };


       /* double[][] x = {
                { 10.7000, 0.0000, 70.0000, -4.9700, 18.7000 },
                { 12.2000, 3.8000, 65.4000, 3.2600, 18.5000 },
                { 11.7000, 12.0000, 96.9000, 0.4300, 19.1000 },
                { 12.6000, 7.2000, 76.0000, 0.2800, 19.6000 },
                { 12.6000, 9.8000, 95.5000, -7.3700, 21.8000 },
                { 14.4000, 9.4000, 90.3000, -3.0600, 20.4000 },
                { 10.8000, 8.1000, 53.0000, 1.2200, 19.1000 },
                { 12.2000, 18.8000, 88.9000, 3.2600, 18.5000 },
                { 13.1000, 13.8000, 52.7000, -3.8600, 19.8000 },
                { 12.2000, 8.1000, 83.1000, -7.7700, 21.2000 },

        }; */
        //double[] y = { 215, 40, 157, 58, 181, 163, 88, 112, 62, 146 };
        MultipleLinearRegression regression = new MultipleLinearRegression(x, y);

        System.out.printf("%.4fa + %.4fb + %.4fc + %.4fd + %.4fe + %.4ff + %.4fg + %.4fh + %.4fi + %.4fj + %.4fk + %.4fl + %.4fm + %.4fn + %.4fo + %.4fp + %.4fq + %.4fr + %.4fs + %.4ft + %.4fu + %.4fv + %.4fw + %.4fx + %.4fy + %.4fz + %.4fa1 + %.4fb1 (R^2 = %.2f)\n",
                regression.beta(0), regression.beta(1), regression.beta(2), regression.beta(3),
                regression.beta(4), regression.beta(5), regression.beta(6), regression.beta(7),
                regression.beta(8), regression.beta(9), regression.beta(10), regression.beta(11),
                regression.beta(12), regression.beta(13), regression.beta(14), regression.beta(15),
                regression.beta(16), regression.beta(17), regression.beta(18), regression.beta(19),
                regression.beta(20), regression.beta(21), regression.beta(22), regression.beta(23),
                regression.beta(24), regression.beta(25), regression.beta(26), regression.beta(27),
                regression.R2());


        /*System.out.printf("%.4fa + %.4fb + %.4fc + %.4fd + %.4fe | (R^2 = %.2f)\n",
                regression.beta(0), regression.beta(1), regression.beta(2), regression.beta(3), regression.beta(4), regression.R2());
        */
    }

}